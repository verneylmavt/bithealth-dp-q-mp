SELECT
    p.name,
    p.age,
    v.visit_date,
    COUNT(s.id) AS symptom_count
FROM visits AS v
JOIN patients AS p
    ON v.patient_id = p.id
JOIN symptoms AS s
    ON s.visit_id = v.id
WHERE
    v.department = 'Neurology'
    AND p.age > 50
GROUP BY
    v.id,
    p.name,
    p.age,
    v.visit_date
HAVING
    COUNT(s.id) >= 3
ORDER BY
    v.visit_date DESC
LIMIT 5;